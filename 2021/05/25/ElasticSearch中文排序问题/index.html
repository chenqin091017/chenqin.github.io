<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <title>
    ElasticSearch中文排序问题 |
    
    CUBE</title>
  
  <link rel="shortcut icon" href="/favicon.ico">
  
  
<link rel="stylesheet" href="/css/style.css">

  
  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<script src="/js/pace.min.js"></script>

<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <main class="content">
    <section class="outer">
  <article id="post-ElasticSearch中文排序问题" class="article article-type-post" itemscope
  itemprop="blogPost" data-scroll-reveal>

  <div class="article-inner">
    
    <header class="article-header">
      

<h1 class="article-title" itemprop="name">
  ElasticSearch中文排序问题
</h1>



    </header>
    

    
    <div class="article-meta">
      <a href="/2021/05/25/ElasticSearch%E4%B8%AD%E6%96%87%E6%8E%92%E5%BA%8F%E9%97%AE%E9%A2%98/" class="article-date">
  <time datetime="2021-05-24T16:00:00.000Z" itemprop="datePublished">2021-05-25</time>
</a>
      
<div class="article-category">
  <a class="article-category-link" href="/categories/Elasticsearch/">Elasticsearch</a>
</div>

    </div>
    

    
    
<div class="tocbot"></div>

    

    <div class="article-entry" itemprop="articleBody">
      
      
      
      <h2 id="1需求"><a href="#1需求" class="headerlink" title="1需求"></a>1需求</h2><p>中文需要根据首字母进行排序比较，而ElasticSearch的排序规则是根据ASCII码，所以从人的感知上是没有任何的顺序规则的。</p>
<p>另外由于部分字段使用的analyzer使用ngram_analyzer或者ik_analyzer，在满足以上analyzer的同时，则需要使用ElasticSearch中index mapping字段的fields配置，用来不同的方式进行analyzer。</p>
<span id="more"></span>

<h2 id="2解决方法"><a href="#2解决方法" class="headerlink" title="2解决方法"></a>2解决方法</h2><h3 id="2-1-Quickstart-elasticsearch-analysis-pinyin"><a href="#2-1-Quickstart-elasticsearch-analysis-pinyin" class="headerlink" title="2.1 Quickstart elasticsearch-analysis-pinyin"></a>2.1 Quickstart <code>elasticsearch-analysis-pinyin</code></h3><h4 id="2-1-1-Install-elasticsearhc-analysis-pinyin"><a href="#2-1-1-Install-elasticsearhc-analysis-pinyin" class="headerlink" title="2.1.1 Install elasticsearhc-analysis-pinyin"></a>2.1.1 Install <code>elasticsearhc-analysis-pinyin</code></h4><blockquote>
<p>Docker下运行ElasticSearch的时候，进行安装</p>
</blockquote>
<ul>
<li><p>Run a command in a running container</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker exec -it docker-elasticsearch bash</span><br></pre></td></tr></table></figure>

<p><em><code>corehr-elasticsearch</code>为container name</em></p>
</li>
<li><p>Install <code>elasticsearch-analysis-pinyin</code> by <code>elasticsearch-plugin</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">elasticsearch-plugin install https://github.com/medcl/elasticsearch-analysis-pinyin/releases/download/v6.8.10/elasticsearch-analysis-pinyin-6.8.10.zip</span><br></pre></td></tr></table></figure></li>
<li><p>Restart container</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker restart docker-elasticsearch</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="2-1-2-Test-Anaylyzer-analyzing-a-chinese-name，such-as-经理-J0001A01"><a href="#2-1-2-Test-Anaylyzer-analyzing-a-chinese-name，such-as-经理-J0001A01" class="headerlink" title="2.1.2 Test Anaylyzer,analyzing a chinese name，such as 经理+J0001A01"></a>2.1.2 Test Anaylyzer,analyzing a chinese name，such as <code>经理+J0001A01</code></h4><ul>
<li><p>Request</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">###</span><br><span class="line">POST &#123;&#123;host&#125;&#125;/_analyze</span><br><span class="line">Content-Type: application/json</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;tokenizer&quot;</span>:&#123;</span><br><span class="line">        <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;pinyin&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;keep_first_letter&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="attr">&quot;keep_full_pinyin&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="attr">&quot;keep_joined_full_pinyin&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">&quot;keep_none_chinese_in_joined_full_pinyin&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">&quot;keep_none_chinese_in_first_letter&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">&quot;none_chinese_pinyin_tokenize&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="attr">&quot;lowercase&quot;</span> : <span class="literal">false</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;text&quot;</span>:<span class="string">&quot;经理+J0001A01&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Optional Parameters可以查看参考<a href="#refer-anchor-1"><sup>1</sup></a>，上述举例的配置为了得到一个token，便于排序，而不是为了进行搜索。</p>
</li>
<li><p>Response</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;tokens&quot;</span>:[</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">&quot;token&quot;</span>:<span class="string">&quot;jingliJ0001A01&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;start_offset&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;end_offset&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;type&quot;</span>:<span class="string">&quot;word&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;position&quot;</span>:<span class="number">0</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>Request</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">###</span><br><span class="line">POST &#123;&#123;host&#125;&#125;/_analyze</span><br><span class="line">Content-Type: application/json</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;tokenizer&quot;</span>:&#123;</span><br><span class="line">        <span class="attr">&quot;type&quot;</span> : <span class="string">&quot;pinyin&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;keep_first_letter&quot;</span>:<span class="literal">true</span>,</span><br><span class="line">        <span class="attr">&quot;keep_separate_first_letter&quot;</span> : <span class="literal">false</span>,</span><br><span class="line">        <span class="attr">&quot;keep_full_pinyin&quot;</span> : <span class="literal">false</span>,</span><br><span class="line">        <span class="attr">&quot;limit_first_letter_length&quot;</span> : <span class="number">20</span>,</span><br><span class="line">        <span class="attr">&quot;lowercase&quot;</span> : <span class="literal">false</span>,</span><br><span class="line">        <span class="attr">&quot;keep_none_chinese&quot;</span>:<span class="literal">false</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;text&quot;</span>:<span class="string">&quot;中华人民共和国&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>Response</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;tokens&quot;</span>:[</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">&quot;token&quot;</span>:<span class="string">&quot;zhrmghg&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;start_offset&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;end_offset&quot;</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;type&quot;</span>:<span class="string">&quot;word&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;position&quot;</span>:<span class="number">0</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="2-2-Create-index-using-elasticsearch-analyzer-pinyin"><a href="#2-2-Create-index-using-elasticsearch-analyzer-pinyin" class="headerlink" title="2.2 Create index,using elasticsearch-analyzer-pinyin"></a>2.2 Create index,using elasticsearch-analyzer-pinyin</h3><h4 id="2-2-1-Add-a-new-index"><a href="#2-2-1-Add-a-new-index" class="headerlink" title="2.2.1 Add a new index"></a>2.2.1 Add a new index</h4><blockquote>
<p>Define yourself analyzer by settings, for example ngram_analyzer,ik_analyzer,pinyin_analyzer and so on;</p>
</blockquote>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">###</span><br><span class="line">PUT &#123;&#123;host&#125;&#125;/bar</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    &quot;settings&quot;:&#123;</span><br><span class="line">        &quot;analysis&quot;:&#123;</span><br><span class="line">            &quot;analyzer&quot;:&#123;</span><br><span class="line">                &quot;ngram_analyzer&quot;:&#123;</span><br><span class="line">                    &quot;tokenizer&quot;:&quot;ngram_tokenizer&quot;,</span><br><span class="line">                    &quot;filter&quot;:[</span><br><span class="line">                        &quot;lowercase&quot;</span><br><span class="line">                    ]</span><br><span class="line">                &#125;,</span><br><span class="line">                &quot;ik_analyzer&quot;:&#123;</span><br><span class="line">                    &quot;tokenizer&quot;:&quot;ik_max_word&quot;,</span><br><span class="line">                    &quot;filter&quot;:[</span><br><span class="line">                        &quot;lowercase&quot;</span><br><span class="line">                    ]</span><br><span class="line">                &#125;,</span><br><span class="line">                &quot;my_keyword&quot;:&#123;</span><br><span class="line">                    &quot;tokenizer&quot;:&quot;keyword&quot;,</span><br><span class="line">                    &quot;filter&quot;:[&quot;lowercase&quot;]</span><br><span class="line">                &#125;,</span><br><span class="line">                &quot;pinyin_analyzer&quot;:&#123;</span><br><span class="line">                    &quot;tokenizer&quot;: &quot;my_pinyin&quot;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;tokenizer&quot;:&#123;</span><br><span class="line">                &quot;ngram_tokenizer&quot;:&#123;</span><br><span class="line">                    &quot;type&quot;:&quot;ngram&quot;,</span><br><span class="line">                    &quot;min_gram&quot;:1,</span><br><span class="line">                    &quot;max_gram&quot;:50</span><br><span class="line">                &#125;,</span><br><span class="line">                &quot;my_pinyin&quot;:&#123;</span><br><span class="line">                    &quot;type&quot;: &quot;pinyin&quot;,</span><br><span class="line">                    &quot;keep_first_letter&quot;: false,</span><br><span class="line">                    &quot;keep_full_pinyin&quot;: false,</span><br><span class="line">                    &quot;keep_joined_full_pinyin&quot;: true,</span><br><span class="line">                    &quot;keep_none_chinese_in_joined_full_pinyin&quot;: true,</span><br><span class="line">                    &quot;keep_none_chinese_in_first_letter&quot;: true,</span><br><span class="line">                    &quot;none_chinese_pinyin_tokenize&quot;: false,</span><br><span class="line">                    &quot;lowercase&quot; : false</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>其中<code>ngram_analyzer</code>，<code>ik_analyzer</code>和<code>my_keyword</code>为已有配置，新增<code>pinyin_analyzer</code></p>
</blockquote>
<h4 id="2-2-2-Define-a-document"><a href="#2-2-2-Define-a-document" class="headerlink" title="2.2.2 Define a document"></a>2.2.2 Define a document</h4><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">###</span><br><span class="line">POST  &#123;&#123;host&#125;&#125;/bar/_doc/_mapping</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    &quot;properties&quot;:&#123;</span><br><span class="line">        &quot;content&quot;:&#123;</span><br><span class="line">            &quot;type&quot;:&quot;text&quot;,</span><br><span class="line">            &quot;analyzer&quot;:&quot;ik_analyzer&quot;,</span><br><span class="line">            &quot;search_analyzer&quot;:&quot;ik_max_word&quot;,</span><br><span class="line">            &quot;fields&quot;:&#123;</span><br><span class="line">                &quot;keyword&quot;:&#123;</span><br><span class="line">                    &quot;ignore_above&quot;:256,</span><br><span class="line">                    &quot;type&quot;:&quot;keyword&quot;</span><br><span class="line">                &#125;,</span><br><span class="line">                &quot;pinyin&quot;:&#123;</span><br><span class="line">                    &quot;type&quot;:&quot;text&quot;,</span><br><span class="line">                    &quot;fielddata&quot;:true,</span><br><span class="line">                    &quot;analyzer&quot;:&quot;pinyin_analyzer&quot;,</span><br><span class="line">                    &quot;boost&quot;:100</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;content1&quot;:&#123;</span><br><span class="line">            &quot;type&quot;:&quot;text&quot;,</span><br><span class="line">            &quot;analyzer&quot;:&quot;ngram_analyzer&quot;,</span><br><span class="line">            &quot;search_analyzer&quot;:&quot;my_keyword&quot;,</span><br><span class="line">            &quot;fields&quot;:&#123;</span><br><span class="line">                &quot;keyword&quot;:&#123;</span><br><span class="line">                    &quot;ignore_above&quot;:256,</span><br><span class="line">                    &quot;type&quot;:&quot;keyword&quot;</span><br><span class="line">                &#125;,</span><br><span class="line">                &quot;pinyin&quot;:&#123;</span><br><span class="line">                    &quot;type&quot;:&quot;text&quot;,</span><br><span class="line">                    &quot;fielddata&quot;:true,</span><br><span class="line">                    &quot;analyzer&quot;:&quot;pinyin_analyzer&quot;,</span><br><span class="line">                    &quot;boost&quot;:100</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;content2&quot;:&#123;</span><br><span class="line">            &quot;type&quot;:&quot;nested&quot;,</span><br><span class="line">            &quot;properties&quot;:&#123;</span><br><span class="line">                &quot;fooNested&quot;:&#123;</span><br><span class="line">                    &quot;type&quot;:&quot;text&quot;,</span><br><span class="line">                    &quot;analyzer&quot;:&quot;ngram_analyzer&quot;,</span><br><span class="line">                    &quot;search_analyzer&quot;:&quot;my_keyword&quot;,</span><br><span class="line">                    &quot;fields&quot;:&#123;</span><br><span class="line">                        &quot;keyword&quot;:&#123;</span><br><span class="line">                            &quot;ignore_above&quot;:256,</span><br><span class="line">                            &quot;type&quot;:&quot;keyword&quot;</span><br><span class="line">                        &#125;,</span><br><span class="line">                        &quot;pinyin&quot;:&#123;</span><br><span class="line">                            &quot;type&quot;:&quot;text&quot;,</span><br><span class="line">                            &quot;fielddata&quot;:true,</span><br><span class="line">                            &quot;analyzer&quot;:&quot;pinyin_analyzer&quot;,</span><br><span class="line">                            &quot;boost&quot;:100</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>由于字段已经定义analyzer，所以需要fields来对字段进行不同方式的分析<a href="#refer-anchor-2"><sup>2</sup></a></p>
</blockquote>
<h4 id="2-2-3-Runing-test-data"><a href="#2-2-3-Runing-test-data" class="headerlink" title="2.2.3 Runing test data"></a>2.2.3 Runing test data</h4><blockquote>
<p>测试数据，包含数字、大小写英文，中文，中文+英文等</p>
</blockquote>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">###curl -X POST &quot;localhost:9200/bar/_bulk&quot; -H &#x27;Content-Type: application/json&#x27; --data-binary @request</span><br><span class="line">POST  &#123;&#123;host&#125;&#125;/_bulk</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"></span><br><span class="line">&#123;&quot;index&quot;: &#123;&quot;_index&quot;: &quot;bar&quot;, &quot;_type&quot;: &quot;_doc&quot;, &quot;_id&quot;: 1&#125;&#125;</span><br><span class="line">&#123;&quot;content&quot;:&quot;一级主办员其他&quot;,&quot;content1&quot;:&quot;一级主办员其他&quot;,&quot;content2&quot;:&#123;&quot;fooNested&quot;:&quot;一级主办员其他&quot;&#125;&#125;</span><br><span class="line">&#123;&quot;index&quot;: &#123;&quot;_index&quot;: &quot;bar&quot;, &quot;_type&quot;: &quot;_doc&quot;, &quot;_id&quot;: 2&#125;</span><br><span class="line">&#123;&quot;content&quot;:&quot;二级主办员其他&quot;,&quot;content1&quot;:&quot;二级主办员其他&quot;,&quot;content2&quot;:&#123;&quot;fooNested&quot;:&quot;二级主办员其他&quot;&#125;&#125;</span><br><span class="line">&#123;&quot;index&quot;: &#123;&quot;_index&quot;: &quot;bar&quot;, &quot;_type&quot;: &quot;_doc&quot;, &quot;_id&quot;: 3&#125;&#125;</span><br><span class="line">&#123;&quot;content&quot;:&quot;1级主办员其他&quot;,&quot;content1&quot;:&quot;1级主办员其他&quot;,&quot;content2&quot;:&#123;&quot;fooNested&quot;:&quot;1级主办员其他&quot;&#125;&#125;</span><br><span class="line">&#123;&quot;index&quot;: &#123;&quot;_index&quot;: &quot;bar&quot;, &quot;_type&quot;: &quot;_doc&quot;, &quot;_id&quot;: 4&#125;&#125;</span><br><span class="line">&#123;&quot;content&quot;:&quot;2级主办员其他&quot;,&quot;content1&quot;:&quot;2级主办员其他&quot;,&quot;content2&quot;:&#123;&quot;fooNested&quot;:&quot;2级主办员其他&quot;&#125;&#125;</span><br><span class="line">&#123;&quot;index&quot;: &#123;&quot;_index&quot;: &quot;bar&quot;, &quot;_type&quot;: &quot;_doc&quot;, &quot;_id&quot;: 5&#125;&#125;</span><br><span class="line">&#123;&quot;content&quot;:&quot;A级主办员其他&quot;,&quot;content1&quot;:&quot;A级主办员其他&quot;,&quot;content2&quot;:&#123;&quot;fooNested&quot;:&quot;A级主办员其他&quot;&#125;&#125;</span><br><span class="line">&#123;&quot;index&quot;: &#123;&quot;_index&quot;: &quot;bar&quot;, &quot;_type&quot;: &quot;_doc&quot;, &quot;_id&quot;: 6&#125;&#125;</span><br><span class="line">&#123;&quot;content&quot;:&quot;B级主办员其他&quot;,&quot;content1&quot;:&quot;B级主办员其他&quot;,&quot;content2&quot;:&#123;&quot;fooNested&quot;:&quot;B级主办员其他&quot;&#125;&#125;</span><br><span class="line">&#123;&quot;index&quot;: &#123;&quot;_index&quot;: &quot;bar&quot;, &quot;_type&quot;: &quot;_doc&quot;, &quot;_id&quot;: 7&#125;&#125;</span><br><span class="line">&#123;&quot;content&quot;:&quot;a级主办员其他&quot;,&quot;content1&quot;:&quot;a级主办员其他&quot;,&quot;content2&quot;:&#123;&quot;fooNested&quot;:&quot;a级主办员其他&quot;&#125;&#125;</span><br><span class="line">&#123;&quot;index&quot;: &#123;&quot;_index&quot;: &quot;bar&quot;, &quot;_type&quot;: &quot;_doc&quot;, &quot;_id&quot;: 8&#125;&#125;</span><br><span class="line">&#123;&quot;content&quot;:&quot;b级主办员其他&quot;,&quot;content1&quot;:&quot;b级主办员其他&quot;,&quot;content2&quot;:&#123;&quot;fooNested&quot;:&quot;b级主办员其他&quot;&#125;&#125;</span><br><span class="line">&#123;&quot;index&quot;: &#123;&quot;_index&quot;: &quot;bar&quot;, &quot;_type&quot;: &quot;_doc&quot;, &quot;_id&quot;: 9&#125;&#125;</span><br><span class="line">&#123;&quot;content&quot;:&quot;aa级主办员其他&quot;,&quot;content1&quot;:&quot;aa级主办员其他&quot;,&quot;content2&quot;:&#123;&quot;fooNested&quot;:&quot;aa级主办员其他&quot;&#125;&#125;</span><br><span class="line">&#123;&quot;index&quot;: &#123;&quot;_index&quot;: &quot;bar&quot;, &quot;_type&quot;: &quot;_doc&quot;, &quot;_id&quot;: 10&#125;&#125;</span><br><span class="line">&#123;&quot;content&quot;:&quot;百级主办员其他&quot;,&quot;content1&quot;:&quot;百级主办员其他&quot;,&quot;content2&quot;:&#123;&quot;fooNested&quot;:&quot;百级主办员其他&quot;&#125;&#125;</span><br><span class="line">&#123;&quot;index&quot;: &#123;&quot;_index&quot;: &quot;bar&quot;, &quot;_type&quot;: &quot;_doc&quot;, &quot;_id&quot;: 11&#125;&#125;</span><br><span class="line">&#123;&quot;content&quot;:&quot;级主&quot;,&quot;content1&quot;:&quot;级主&quot;,&quot;content2&quot;:&#123;&quot;fooNested&quot;:&quot;级主&quot;&#125;&#125;</span><br><span class="line">&#123;&quot;index&quot;: &#123;&quot;_index&quot;: &quot;bar&quot;, &quot;_type&quot;: &quot;_doc&quot;, &quot;_id&quot;: 12&#125;&#125;</span><br><span class="line">&#123;&quot;content&quot;:&quot;ad级主办员其他&quot;,&quot;content1&quot;:&quot;ad级主办员其他&quot;,&quot;content2&quot;:&#123;&quot;fooNested&quot;:&quot;ad级主办员其他&quot;&#125;&#125;</span><br><span class="line">&#123;&quot;index&quot;: &#123;&quot;_index&quot;: &quot;bar&quot;, &quot;_type&quot;: &quot;_doc&quot;, &quot;_id&quot;: 13&#125;&#125;</span><br><span class="line">&#123;&quot;content&quot;:&quot;ac级主办员其他&quot;,&quot;content1&quot;:&quot;ac级主办员其他&quot;,&quot;content2&quot;:&#123;&quot;fooNested&quot;:&quot;ac级主办员其他&quot;&#125;&#125;</span><br><span class="line">&#123;&quot;index&quot;: &#123;&quot;_index&quot;: &quot;bar&quot;, &quot;_type&quot;: &quot;_doc&quot;, &quot;_id&quot;: 14&#125;&#125;</span><br><span class="line">&#123;&quot;content&quot;:&quot;主办&quot;,&quot;content1&quot;:&quot;主办&quot;,&quot;content2&quot;:&#123;&quot;fooNested&quot;:&quot;主办&quot;&#125;&#125;</span><br><span class="line">&#123;&quot;index&quot;: &#123;&quot;_index&quot;: &quot;bar&quot;, &quot;_type&quot;: &quot;_doc&quot;, &quot;_id&quot;: 15&#125;&#125;</span><br><span class="line">&#123;&quot;content&quot;:&quot;办员&quot;,&quot;content1&quot;:&quot;办员&quot;,&quot;content2&quot;:&#123;&quot;fooNested&quot;:&quot;办员&quot;&#125;&#125;</span><br><span class="line">&#123;&quot;index&quot;: &#123;&quot;_index&quot;: &quot;bar&quot;, &quot;_type&quot;: &quot;_doc&quot;, &quot;_id&quot;: 16&#125;&#125;</span><br><span class="line">&#123;&quot;content&quot;:&quot;中国人民政府zhonguoshanghai13154123中国人民政府&quot;,&quot;content1&quot;:&quot;中国人民政府zhonguoshanghai13154123中国人民政府&quot;,&quot;content2&quot;:&#123;&quot;fooNested&quot;:&quot;中国人民政府zhonguoshanghai13154123中国人民政府&quot;&#125;&#125;</span><br><span class="line">&#123;&quot;index&quot;: &#123;&quot;_index&quot;: &quot;bar&quot;, &quot;_type&quot;: &quot;_doc&quot;, &quot;_id&quot;: 17&#125;&#125;</span><br><span class="line">&#123;&quot;content&quot;:&quot;中国人民政府zhonguoshanghai13154123&quot;,&quot;content1&quot;:&quot;中国人民政府zhonguoshanghai13154123&quot;,&quot;content2&quot;:&#123;&quot;fooNested&quot;:&quot;中国人民政府zhonguoshanghai13154123&quot;&#125;&#125;</span><br><span class="line">&#123;&quot;index&quot;: &#123;&quot;_index&quot;: &quot;bar&quot;, &quot;_type&quot;: &quot;_doc&quot;, &quot;_id&quot;: 18&#125;&#125;</span><br><span class="line">&#123;&quot;content&quot;:&quot;king中国&quot;,&quot;content1&quot;:&quot;king中国&quot;,&quot;content2&quot;:&#123;&quot;fooNested&quot;:&quot;king中国&quot;&#125;&#125;</span><br><span class="line">&#123;&quot;index&quot;: &#123;&quot;_index&quot;: &quot;bar&quot;, &quot;_type&quot;: &quot;_doc&quot;, &quot;_id&quot;: 19&#125;&#125;</span><br><span class="line">&#123;&quot;content&quot;:&quot;经理J0001A01&quot;,&quot;content1&quot;:&quot;经理J0001A01&quot;,&quot;content2&quot;:&#123;&quot;fooNested&quot;:&quot;经理J0001A01&quot;&#125;&#125;</span><br><span class="line">&#123;&quot;index&quot;: &#123;&quot;_index&quot;: &quot;bar&quot;, &quot;_type&quot;: &quot;_doc&quot;, &quot;_id&quot;: 20&#125;&#125;</span><br><span class="line">&#123;&quot;content&quot;:&quot;foo-9&quot;,&quot;content1&quot;:&quot;foo-9&quot;,&quot;content2&quot;:&#123;&quot;fooNested&quot;:&quot;foo-9&quot;&#125;&#125;</span><br><span class="line">&#123;&quot;index&quot;: &#123;&quot;_index&quot;: &quot;bar&quot;, &quot;_type&quot;: &quot;_doc&quot;, &quot;_id&quot;: 21&#125;&#125;</span><br><span class="line">&#123;&quot;content&quot;:&quot;经理+J0001A01&quot;,&quot;content1&quot;:&quot;经理+J0001A01&quot;,&quot;content2&quot;:&#123;&quot;fooNested&quot;:&quot;经理+J0001A01&quot;&#125;&#125;</span><br><span class="line">&#123;&quot;index&quot;: &#123;&quot;_index&quot;: &quot;bar&quot;, &quot;_type&quot;: &quot;_doc&quot;, &quot;_id&quot;: 22&#125;&#125;</span><br><span class="line">&#123;&quot;content&quot;:&quot;ExternalId*+_38&quot;,&quot;content1&quot;:&quot;ExternalId*+_38&quot;,&quot;content2&quot;:&#123;&quot;fooNested&quot;:&quot;ExternalId*+_38&quot;&#125;&#125;</span><br><span class="line">&#123;&quot;index&quot;: &#123;&quot;_index&quot;: &quot;bar&quot;, &quot;_type&quot;: &quot;_doc&quot;, &quot;_id&quot;: 23&#125;&#125;</span><br><span class="line">&#123;&quot;content&quot;:&quot;ch_1008&quot;,&quot;content1&quot;:&quot;ch_1008&quot;,&quot;content2&quot;:&#123;&quot;fooNested&quot;:&quot;ch_1008&quot;&#125;&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="2-2-4-Sort-by-fields3"><a href="#2-2-4-Sort-by-fields3" class="headerlink" title="2.2.4 Sort by fields3"></a>2.2.4 Sort by fields<a href="#refer-anchor-3"><sup>3</sup></a></h4><ul>
<li><p>Request</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">###</span><br><span class="line">GET  &#123;&#123;host&#125;&#125;/bar/_search</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    &quot;query&quot;:&#123;</span><br><span class="line">        &quot;match_all&quot;:&#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;from&quot;:0,</span><br><span class="line">    &quot;size&quot;:23,</span><br><span class="line">    &quot;sort&quot;:&#123;</span><br><span class="line">        &quot;content1.pinyin&quot;:&#123;</span><br><span class="line">            &quot;order&quot;:&quot;asc&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>Response</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">&quot;took&quot;</span>:<span class="number">5</span>,<span class="attr">&quot;timed_out&quot;</span>:<span class="literal">false</span>,<span class="attr">&quot;_shards&quot;</span>:&#123;<span class="attr">&quot;total&quot;</span>:<span class="number">5</span>,<span class="attr">&quot;successful&quot;</span>:<span class="number">5</span>,<span class="attr">&quot;skipped&quot;</span>:<span class="number">0</span>,<span class="attr">&quot;failed&quot;</span>:<span class="number">0</span>&#125;,<span class="attr">&quot;hits&quot;</span>:&#123;<span class="attr">&quot;total&quot;</span>:<span class="number">23</span>,<span class="attr">&quot;max_score&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;hits&quot;</span>:[&#123;<span class="attr">&quot;_index&quot;</span>:<span class="string">&quot;bar&quot;</span>,<span class="attr">&quot;_type&quot;</span>:<span class="string">&quot;_doc&quot;</span>,<span class="attr">&quot;_id&quot;</span>:<span class="string">&quot;3&quot;</span>,<span class="attr">&quot;_score&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;_source&quot;</span>:&#123;<span class="attr">&quot;content&quot;</span>:<span class="string">&quot;1级主办员其他&quot;</span>,<span class="attr">&quot;content1&quot;</span>:<span class="string">&quot;1级主办员其他&quot;</span>,<span class="attr">&quot;content2&quot;</span>:&#123;<span class="attr">&quot;fooNested&quot;</span>:<span class="string">&quot;1级主办员其他&quot;</span>&#125;&#125;,<span class="attr">&quot;sort&quot;</span>:[<span class="string">&quot;1级主办员其他&quot;</span>,<span class="string">&quot;1jizhubanyuanqita&quot;</span>]&#125;,&#123;<span class="attr">&quot;_index&quot;</span>:<span class="string">&quot;bar&quot;</span>,<span class="attr">&quot;_type&quot;</span>:<span class="string">&quot;_doc&quot;</span>,<span class="attr">&quot;_id&quot;</span>:<span class="string">&quot;4&quot;</span>,<span class="attr">&quot;_score&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;_source&quot;</span>:&#123;<span class="attr">&quot;content&quot;</span>:<span class="string">&quot;2级主办员其他&quot;</span>,<span class="attr">&quot;content1&quot;</span>:<span class="string">&quot;2级主办员其他&quot;</span>,<span class="attr">&quot;content2&quot;</span>:&#123;<span class="attr">&quot;fooNested&quot;</span>:<span class="string">&quot;2级主办员其他&quot;</span>&#125;&#125;,<span class="attr">&quot;sort&quot;</span>:[<span class="string">&quot;2级主办员其他&quot;</span>,<span class="string">&quot;2jizhubanyuanqita&quot;</span>]&#125;,&#123;<span class="attr">&quot;_index&quot;</span>:<span class="string">&quot;bar&quot;</span>,<span class="attr">&quot;_type&quot;</span>:<span class="string">&quot;_doc&quot;</span>,<span class="attr">&quot;_id&quot;</span>:<span class="string">&quot;5&quot;</span>,<span class="attr">&quot;_score&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;_source&quot;</span>:&#123;<span class="attr">&quot;content&quot;</span>:<span class="string">&quot;A级主办员其他&quot;</span>,<span class="attr">&quot;content1&quot;</span>:<span class="string">&quot;A级主办员其他&quot;</span>,<span class="attr">&quot;content2&quot;</span>:&#123;<span class="attr">&quot;fooNested&quot;</span>:<span class="string">&quot;A级主办员其他&quot;</span>&#125;&#125;,<span class="attr">&quot;sort&quot;</span>:[<span class="string">&quot;A级主办员其他&quot;</span>,<span class="string">&quot;Ajizhubanyuanqita&quot;</span>]&#125;,&#123;<span class="attr">&quot;_index&quot;</span>:<span class="string">&quot;bar&quot;</span>,<span class="attr">&quot;_type&quot;</span>:<span class="string">&quot;_doc&quot;</span>,<span class="attr">&quot;_id&quot;</span>:<span class="string">&quot;6&quot;</span>,<span class="attr">&quot;_score&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;_source&quot;</span>:&#123;<span class="attr">&quot;content&quot;</span>:<span class="string">&quot;B级主办员其他&quot;</span>,<span class="attr">&quot;content1&quot;</span>:<span class="string">&quot;B级主办员其他&quot;</span>,<span class="attr">&quot;content2&quot;</span>:&#123;<span class="attr">&quot;fooNested&quot;</span>:<span class="string">&quot;B级主办员其他&quot;</span>&#125;&#125;,<span class="attr">&quot;sort&quot;</span>:[<span class="string">&quot;B级主办员其他&quot;</span>,<span class="string">&quot;Bjizhubanyuanqita&quot;</span>]&#125;,&#123;<span class="attr">&quot;_index&quot;</span>:<span class="string">&quot;bar&quot;</span>,<span class="attr">&quot;_type&quot;</span>:<span class="string">&quot;_doc&quot;</span>,<span class="attr">&quot;_id&quot;</span>:<span class="string">&quot;22&quot;</span>,<span class="attr">&quot;_score&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;_source&quot;</span>:&#123;<span class="attr">&quot;content&quot;</span>:<span class="string">&quot;ExternalId*+_38&quot;</span>,<span class="attr">&quot;content1&quot;</span>:<span class="string">&quot;ExternalId*+_38&quot;</span>,<span class="attr">&quot;content2&quot;</span>:&#123;<span class="attr">&quot;fooNested&quot;</span>:<span class="string">&quot;ExternalId*+_38&quot;</span>&#125;&#125;,<span class="attr">&quot;sort&quot;</span>:[<span class="string">&quot;ExternalId*+_38&quot;</span>,<span class="string">&quot;ExternalId38&quot;</span>]&#125;,&#123;<span class="attr">&quot;_index&quot;</span>:<span class="string">&quot;bar&quot;</span>,<span class="attr">&quot;_type&quot;</span>:<span class="string">&quot;_doc&quot;</span>,<span class="attr">&quot;_id&quot;</span>:<span class="string">&quot;9&quot;</span>,<span class="attr">&quot;_score&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;_source&quot;</span>:&#123;<span class="attr">&quot;content&quot;</span>:<span class="string">&quot;aa级主办员其他&quot;</span>,<span class="attr">&quot;content1&quot;</span>:<span class="string">&quot;aa级主办员其他&quot;</span>,<span class="attr">&quot;content2&quot;</span>:&#123;<span class="attr">&quot;fooNested&quot;</span>:<span class="string">&quot;aa级主办员其他&quot;</span>&#125;&#125;,<span class="attr">&quot;sort&quot;</span>:[<span class="string">&quot;aa级主办员其他&quot;</span>,<span class="string">&quot;aajizhubanyuanqita&quot;</span>]&#125;,&#123;<span class="attr">&quot;_index&quot;</span>:<span class="string">&quot;bar&quot;</span>,<span class="attr">&quot;_type&quot;</span>:<span class="string">&quot;_doc&quot;</span>,<span class="attr">&quot;_id&quot;</span>:<span class="string">&quot;13&quot;</span>,<span class="attr">&quot;_score&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;_source&quot;</span>:&#123;<span class="attr">&quot;content&quot;</span>:<span class="string">&quot;ac级主办员其他&quot;</span>,<span class="attr">&quot;content1&quot;</span>:<span class="string">&quot;ac级主办员其他&quot;</span>,<span class="attr">&quot;content2&quot;</span>:&#123;<span class="attr">&quot;fooNested&quot;</span>:<span class="string">&quot;ac级主办员其他&quot;</span>&#125;&#125;,<span class="attr">&quot;sort&quot;</span>:[<span class="string">&quot;ac级主办员其他&quot;</span>,<span class="string">&quot;acjizhubanyuanqita&quot;</span>]&#125;,&#123;<span class="attr">&quot;_index&quot;</span>:<span class="string">&quot;bar&quot;</span>,<span class="attr">&quot;_type&quot;</span>:<span class="string">&quot;_doc&quot;</span>,<span class="attr">&quot;_id&quot;</span>:<span class="string">&quot;12&quot;</span>,<span class="attr">&quot;_score&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;_source&quot;</span>:&#123;<span class="attr">&quot;content&quot;</span>:<span class="string">&quot;ad级主办员其他&quot;</span>,<span class="attr">&quot;content1&quot;</span>:<span class="string">&quot;ad级主办员其他&quot;</span>,<span class="attr">&quot;content2&quot;</span>:&#123;<span class="attr">&quot;fooNested&quot;</span>:<span class="string">&quot;ad级主办员其他&quot;</span>&#125;&#125;,<span class="attr">&quot;sort&quot;</span>:[<span class="string">&quot;ad级主办员其他&quot;</span>,<span class="string">&quot;adjizhubanyuanqita&quot;</span>]&#125;,&#123;<span class="attr">&quot;_index&quot;</span>:<span class="string">&quot;bar&quot;</span>,<span class="attr">&quot;_type&quot;</span>:<span class="string">&quot;_doc&quot;</span>,<span class="attr">&quot;_id&quot;</span>:<span class="string">&quot;7&quot;</span>,<span class="attr">&quot;_score&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;_source&quot;</span>:&#123;<span class="attr">&quot;content&quot;</span>:<span class="string">&quot;a级主办员其他&quot;</span>,<span class="attr">&quot;content1&quot;</span>:<span class="string">&quot;a级主办员其他&quot;</span>,<span class="attr">&quot;content2&quot;</span>:&#123;<span class="attr">&quot;fooNested&quot;</span>:<span class="string">&quot;a级主办员其他&quot;</span>&#125;&#125;,<span class="attr">&quot;sort&quot;</span>:[<span class="string">&quot;a级主办员其他&quot;</span>,<span class="string">&quot;ajizhubanyuanqita&quot;</span>]&#125;,&#123;<span class="attr">&quot;_index&quot;</span>:<span class="string">&quot;bar&quot;</span>,<span class="attr">&quot;_type&quot;</span>:<span class="string">&quot;_doc&quot;</span>,<span class="attr">&quot;_id&quot;</span>:<span class="string">&quot;8&quot;</span>,<span class="attr">&quot;_score&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;_source&quot;</span>:&#123;<span class="attr">&quot;content&quot;</span>:<span class="string">&quot;b级主办员其他&quot;</span>,<span class="attr">&quot;content1&quot;</span>:<span class="string">&quot;b级主办员其他&quot;</span>,<span class="attr">&quot;content2&quot;</span>:&#123;<span class="attr">&quot;fooNested&quot;</span>:<span class="string">&quot;b级主办员其他&quot;</span>&#125;&#125;,<span class="attr">&quot;sort&quot;</span>:[<span class="string">&quot;b级主办员其他&quot;</span>,<span class="string">&quot;bjizhubanyuanqita&quot;</span>]&#125;,&#123;<span class="attr">&quot;_index&quot;</span>:<span class="string">&quot;bar&quot;</span>,<span class="attr">&quot;_type&quot;</span>:<span class="string">&quot;_doc&quot;</span>,<span class="attr">&quot;_id&quot;</span>:<span class="string">&quot;23&quot;</span>,<span class="attr">&quot;_score&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;_source&quot;</span>:&#123;<span class="attr">&quot;content&quot;</span>:<span class="string">&quot;ch_1008&quot;</span>,<span class="attr">&quot;content1&quot;</span>:<span class="string">&quot;ch_1008&quot;</span>,<span class="attr">&quot;content2&quot;</span>:&#123;<span class="attr">&quot;fooNested&quot;</span>:<span class="string">&quot;ch_1008&quot;</span>&#125;&#125;,<span class="attr">&quot;sort&quot;</span>:[<span class="string">&quot;ch_1008&quot;</span>,<span class="string">&quot;ch1008&quot;</span>]&#125;,&#123;<span class="attr">&quot;_index&quot;</span>:<span class="string">&quot;bar&quot;</span>,<span class="attr">&quot;_type&quot;</span>:<span class="string">&quot;_doc&quot;</span>,<span class="attr">&quot;_id&quot;</span>:<span class="string">&quot;20&quot;</span>,<span class="attr">&quot;_score&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;_source&quot;</span>:&#123;<span class="attr">&quot;content&quot;</span>:<span class="string">&quot;foo-9&quot;</span>,<span class="attr">&quot;content1&quot;</span>:<span class="string">&quot;foo-9&quot;</span>,<span class="attr">&quot;content2&quot;</span>:&#123;<span class="attr">&quot;fooNested&quot;</span>:<span class="string">&quot;foo-9&quot;</span>&#125;&#125;,<span class="attr">&quot;sort&quot;</span>:[<span class="string">&quot;foo-9&quot;</span>,<span class="string">&quot;foo9&quot;</span>]&#125;,&#123;<span class="attr">&quot;_index&quot;</span>:<span class="string">&quot;bar&quot;</span>,<span class="attr">&quot;_type&quot;</span>:<span class="string">&quot;_doc&quot;</span>,<span class="attr">&quot;_id&quot;</span>:<span class="string">&quot;18&quot;</span>,<span class="attr">&quot;_score&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;_source&quot;</span>:&#123;<span class="attr">&quot;content&quot;</span>:<span class="string">&quot;king中国&quot;</span>,<span class="attr">&quot;content1&quot;</span>:<span class="string">&quot;king中国&quot;</span>,<span class="attr">&quot;content2&quot;</span>:&#123;<span class="attr">&quot;fooNested&quot;</span>:<span class="string">&quot;king中国&quot;</span>&#125;&#125;,<span class="attr">&quot;sort&quot;</span>:[<span class="string">&quot;king中国&quot;</span>,<span class="string">&quot;kingzhongguo&quot;</span>]&#125;,&#123;<span class="attr">&quot;_index&quot;</span>:<span class="string">&quot;bar&quot;</span>,<span class="attr">&quot;_type&quot;</span>:<span class="string">&quot;_doc&quot;</span>,<span class="attr">&quot;_id&quot;</span>:<span class="string">&quot;1&quot;</span>,<span class="attr">&quot;_score&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;_source&quot;</span>:&#123;<span class="attr">&quot;content&quot;</span>:<span class="string">&quot;一级主办员其他&quot;</span>,<span class="attr">&quot;content1&quot;</span>:<span class="string">&quot;一级主办员其他&quot;</span>,<span class="attr">&quot;content2&quot;</span>:&#123;<span class="attr">&quot;fooNested&quot;</span>:<span class="string">&quot;一级主办员其他&quot;</span>&#125;&#125;,<span class="attr">&quot;sort&quot;</span>:[<span class="string">&quot;一级主办员其他&quot;</span>,<span class="string">&quot;yijizhubanyuanqita&quot;</span>]&#125;,&#123;<span class="attr">&quot;_index&quot;</span>:<span class="string">&quot;bar&quot;</span>,<span class="attr">&quot;_type&quot;</span>:<span class="string">&quot;_doc&quot;</span>,<span class="attr">&quot;_id&quot;</span>:<span class="string">&quot;17&quot;</span>,<span class="attr">&quot;_score&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;_source&quot;</span>:&#123;<span class="attr">&quot;content&quot;</span>:<span class="string">&quot;中国人民政府zhonguoshanghai13154123&quot;</span>,<span class="attr">&quot;content1&quot;</span>:<span class="string">&quot;中国人民政府zhonguoshanghai13154123&quot;</span>,<span class="attr">&quot;content2&quot;</span>:&#123;<span class="attr">&quot;fooNested&quot;</span>:<span class="string">&quot;中国人民政府zhonguoshanghai13154123&quot;</span>&#125;&#125;,<span class="attr">&quot;sort&quot;</span>:[<span class="string">&quot;中国人民政府zhonguoshanghai13154123&quot;</span>,<span class="string">&quot;zhongguorenminzhengfuzhonguoshanghai13154123&quot;</span>]&#125;,&#123;<span class="attr">&quot;_index&quot;</span>:<span class="string">&quot;bar&quot;</span>,<span class="attr">&quot;_type&quot;</span>:<span class="string">&quot;_doc&quot;</span>,<span class="attr">&quot;_id&quot;</span>:<span class="string">&quot;16&quot;</span>,<span class="attr">&quot;_score&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;_source&quot;</span>:&#123;<span class="attr">&quot;content&quot;</span>:<span class="string">&quot;中国人民政府zhonguoshanghai13154123中国人民政府&quot;</span>,<span class="attr">&quot;content1&quot;</span>:<span class="string">&quot;中国人民政府zhonguoshanghai13154123中国人民政府&quot;</span>,<span class="attr">&quot;content2&quot;</span>:&#123;<span class="attr">&quot;fooNested&quot;</span>:<span class="string">&quot;中国人民政府zhonguoshanghai13154123中国人民政府&quot;</span>&#125;&#125;,<span class="attr">&quot;sort&quot;</span>:[<span class="string">&quot;中国人民政府zhonguoshanghai13154123中国人民政府&quot;</span>,<span class="string">&quot;zhongguorenminzhengfuzhonguoshanghai13154123zhongguorenminzhengfu&quot;</span>]&#125;,&#123;<span class="attr">&quot;_index&quot;</span>:<span class="string">&quot;bar&quot;</span>,<span class="attr">&quot;_type&quot;</span>:<span class="string">&quot;_doc&quot;</span>,<span class="attr">&quot;_id&quot;</span>:<span class="string">&quot;14&quot;</span>,<span class="attr">&quot;_score&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;_source&quot;</span>:&#123;<span class="attr">&quot;content&quot;</span>:<span class="string">&quot;主办&quot;</span>,<span class="attr">&quot;content1&quot;</span>:<span class="string">&quot;主办&quot;</span>,<span class="attr">&quot;content2&quot;</span>:&#123;<span class="attr">&quot;fooNested&quot;</span>:<span class="string">&quot;主办&quot;</span>&#125;&#125;,<span class="attr">&quot;sort&quot;</span>:[<span class="string">&quot;主办&quot;</span>,<span class="string">&quot;zhuban&quot;</span>]&#125;,&#123;<span class="attr">&quot;_index&quot;</span>:<span class="string">&quot;bar&quot;</span>,<span class="attr">&quot;_type&quot;</span>:<span class="string">&quot;_doc&quot;</span>,<span class="attr">&quot;_id&quot;</span>:<span class="string">&quot;2&quot;</span>,<span class="attr">&quot;_score&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;_source&quot;</span>:&#123;<span class="attr">&quot;content&quot;</span>:<span class="string">&quot;二级主办员其他&quot;</span>,<span class="attr">&quot;content1&quot;</span>:<span class="string">&quot;二级主办员其他&quot;</span>,<span class="attr">&quot;content2&quot;</span>:&#123;<span class="attr">&quot;fooNested&quot;</span>:<span class="string">&quot;二级主办员其他&quot;</span>&#125;&#125;,<span class="attr">&quot;sort&quot;</span>:[<span class="string">&quot;二级主办员其他&quot;</span>,<span class="string">&quot;erjizhubanyuanqita&quot;</span>]&#125;,&#123;<span class="attr">&quot;_index&quot;</span>:<span class="string">&quot;bar&quot;</span>,<span class="attr">&quot;_type&quot;</span>:<span class="string">&quot;_doc&quot;</span>,<span class="attr">&quot;_id&quot;</span>:<span class="string">&quot;15&quot;</span>,<span class="attr">&quot;_score&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;_source&quot;</span>:&#123;<span class="attr">&quot;content&quot;</span>:<span class="string">&quot;办员&quot;</span>,<span class="attr">&quot;content1&quot;</span>:<span class="string">&quot;办员&quot;</span>,<span class="attr">&quot;content2&quot;</span>:&#123;<span class="attr">&quot;fooNested&quot;</span>:<span class="string">&quot;办员&quot;</span>&#125;&#125;,<span class="attr">&quot;sort&quot;</span>:[<span class="string">&quot;办员&quot;</span>,<span class="string">&quot;banyuan&quot;</span>]&#125;,&#123;<span class="attr">&quot;_index&quot;</span>:<span class="string">&quot;bar&quot;</span>,<span class="attr">&quot;_type&quot;</span>:<span class="string">&quot;_doc&quot;</span>,<span class="attr">&quot;_id&quot;</span>:<span class="string">&quot;10&quot;</span>,<span class="attr">&quot;_score&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;_source&quot;</span>:&#123;<span class="attr">&quot;content&quot;</span>:<span class="string">&quot;百级主办员其他&quot;</span>,<span class="attr">&quot;content1&quot;</span>:<span class="string">&quot;百级主办员其他&quot;</span>,<span class="attr">&quot;content2&quot;</span>:&#123;<span class="attr">&quot;fooNested&quot;</span>:<span class="string">&quot;百级主办员其他&quot;</span>&#125;&#125;,<span class="attr">&quot;sort&quot;</span>:[<span class="string">&quot;百级主办员其他&quot;</span>,<span class="string">&quot;baijizhubanyuanqita&quot;</span>]&#125;,&#123;<span class="attr">&quot;_index&quot;</span>:<span class="string">&quot;bar&quot;</span>,<span class="attr">&quot;_type&quot;</span>:<span class="string">&quot;_doc&quot;</span>,<span class="attr">&quot;_id&quot;</span>:<span class="string">&quot;11&quot;</span>,<span class="attr">&quot;_score&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;_source&quot;</span>:&#123;<span class="attr">&quot;content&quot;</span>:<span class="string">&quot;级主&quot;</span>,<span class="attr">&quot;content1&quot;</span>:<span class="string">&quot;级主&quot;</span>,<span class="attr">&quot;content2&quot;</span>:&#123;<span class="attr">&quot;fooNested&quot;</span>:<span class="string">&quot;级主&quot;</span>&#125;&#125;,<span class="attr">&quot;sort&quot;</span>:[<span class="string">&quot;级主&quot;</span>,<span class="string">&quot;jizhu&quot;</span>]&#125;,&#123;<span class="attr">&quot;_index&quot;</span>:<span class="string">&quot;bar&quot;</span>,<span class="attr">&quot;_type&quot;</span>:<span class="string">&quot;_doc&quot;</span>,<span class="attr">&quot;_id&quot;</span>:<span class="string">&quot;21&quot;</span>,<span class="attr">&quot;_score&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;_source&quot;</span>:&#123;<span class="attr">&quot;content&quot;</span>:<span class="string">&quot;经理+J0001A01&quot;</span>,<span class="attr">&quot;content1&quot;</span>:<span class="string">&quot;经理+J0001A01&quot;</span>,<span class="attr">&quot;content2&quot;</span>:&#123;<span class="attr">&quot;fooNested&quot;</span>:<span class="string">&quot;经理+J0001A01&quot;</span>&#125;&#125;,<span class="attr">&quot;sort&quot;</span>:[<span class="string">&quot;经理+J0001A01&quot;</span>,<span class="string">&quot;jingliJ0001A01&quot;</span>]&#125;,&#123;<span class="attr">&quot;_index&quot;</span>:<span class="string">&quot;bar&quot;</span>,<span class="attr">&quot;_type&quot;</span>:<span class="string">&quot;_doc&quot;</span>,<span class="attr">&quot;_id&quot;</span>:<span class="string">&quot;19&quot;</span>,<span class="attr">&quot;_score&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;_source&quot;</span>:&#123;<span class="attr">&quot;content&quot;</span>:<span class="string">&quot;经理J0001A01&quot;</span>,<span class="attr">&quot;content1&quot;</span>:<span class="string">&quot;经理J0001A01&quot;</span>,<span class="attr">&quot;content2&quot;</span>:&#123;<span class="attr">&quot;fooNested&quot;</span>:<span class="string">&quot;经理J0001A01&quot;</span>&#125;&#125;,<span class="attr">&quot;sort&quot;</span>:[<span class="string">&quot;经理J0001A01&quot;</span>,<span class="string">&quot;jingliJ0001A01&quot;</span>]&#125;]&#125;&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="2-2-5-Nested-sort3"><a href="#2-2-5-Nested-sort3" class="headerlink" title="2.2.5 Nested sort3"></a>2.2.5 Nested sort<a href="#refer-anchor-3"><sup>3</sup></a></h4><blockquote>
<p>Nested结构的排序</p>
</blockquote>
<ul>
<li><p>Request</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">###</span><br><span class="line">GET  &#123;&#123;host&#125;&#125;/bar/_search</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    &quot;query&quot;:&#123;</span><br><span class="line">        &quot;match_all&quot;:&#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;from&quot;:0,</span><br><span class="line">    &quot;size&quot;:23,</span><br><span class="line">    &quot;sort&quot;:&#123;</span><br><span class="line">        &quot;content2.fooNested.pinyin&quot;:&#123;</span><br><span class="line">            &quot;nested&quot;:&#123;</span><br><span class="line">                &quot;path&quot;:&quot;content2&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;order&quot;:&quot;desc&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>Response</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">&quot;took&quot;</span>:<span class="number">11</span>,<span class="attr">&quot;timed_out&quot;</span>:<span class="literal">false</span>,<span class="attr">&quot;_shards&quot;</span>:&#123;<span class="attr">&quot;total&quot;</span>:<span class="number">5</span>,<span class="attr">&quot;successful&quot;</span>:<span class="number">5</span>,<span class="attr">&quot;skipped&quot;</span>:<span class="number">0</span>,<span class="attr">&quot;failed&quot;</span>:<span class="number">0</span>&#125;,<span class="attr">&quot;hits&quot;</span>:&#123;<span class="attr">&quot;total&quot;</span>:<span class="number">23</span>,<span class="attr">&quot;max_score&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;hits&quot;</span>:[&#123;<span class="attr">&quot;_index&quot;</span>:<span class="string">&quot;bar&quot;</span>,<span class="attr">&quot;_type&quot;</span>:<span class="string">&quot;_doc&quot;</span>,<span class="attr">&quot;_id&quot;</span>:<span class="string">&quot;19&quot;</span>,<span class="attr">&quot;_score&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;_source&quot;</span>:&#123;<span class="attr">&quot;content&quot;</span>:<span class="string">&quot;经理J0001A01&quot;</span>,<span class="attr">&quot;content1&quot;</span>:<span class="string">&quot;经理J0001A01&quot;</span>,<span class="attr">&quot;content2&quot;</span>:&#123;<span class="attr">&quot;fooNested&quot;</span>:<span class="string">&quot;经理J0001A01&quot;</span>&#125;&#125;,<span class="attr">&quot;sort&quot;</span>:[<span class="string">&quot;经理J0001A01&quot;</span>,<span class="string">&quot;jingliJ0001A01&quot;</span>]&#125;,&#123;<span class="attr">&quot;_index&quot;</span>:<span class="string">&quot;bar&quot;</span>,<span class="attr">&quot;_type&quot;</span>:<span class="string">&quot;_doc&quot;</span>,<span class="attr">&quot;_id&quot;</span>:<span class="string">&quot;21&quot;</span>,<span class="attr">&quot;_score&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;_source&quot;</span>:&#123;<span class="attr">&quot;content&quot;</span>:<span class="string">&quot;经理+J0001A01&quot;</span>,<span class="attr">&quot;content1&quot;</span>:<span class="string">&quot;经理+J0001A01&quot;</span>,<span class="attr">&quot;content2&quot;</span>:&#123;<span class="attr">&quot;fooNested&quot;</span>:<span class="string">&quot;经理+J0001A01&quot;</span>&#125;&#125;,<span class="attr">&quot;sort&quot;</span>:[<span class="string">&quot;经理+J0001A01&quot;</span>,<span class="string">&quot;jingliJ0001A01&quot;</span>]&#125;,&#123;<span class="attr">&quot;_index&quot;</span>:<span class="string">&quot;bar&quot;</span>,<span class="attr">&quot;_type&quot;</span>:<span class="string">&quot;_doc&quot;</span>,<span class="attr">&quot;_id&quot;</span>:<span class="string">&quot;11&quot;</span>,<span class="attr">&quot;_score&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;_source&quot;</span>:&#123;<span class="attr">&quot;content&quot;</span>:<span class="string">&quot;级主&quot;</span>,<span class="attr">&quot;content1&quot;</span>:<span class="string">&quot;级主&quot;</span>,<span class="attr">&quot;content2&quot;</span>:&#123;<span class="attr">&quot;fooNested&quot;</span>:<span class="string">&quot;级主&quot;</span>&#125;&#125;,<span class="attr">&quot;sort&quot;</span>:[<span class="string">&quot;级主&quot;</span>,<span class="string">&quot;jizhu&quot;</span>]&#125;,&#123;<span class="attr">&quot;_index&quot;</span>:<span class="string">&quot;bar&quot;</span>,<span class="attr">&quot;_type&quot;</span>:<span class="string">&quot;_doc&quot;</span>,<span class="attr">&quot;_id&quot;</span>:<span class="string">&quot;10&quot;</span>,<span class="attr">&quot;_score&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;_source&quot;</span>:&#123;<span class="attr">&quot;content&quot;</span>:<span class="string">&quot;百级主办员其他&quot;</span>,<span class="attr">&quot;content1&quot;</span>:<span class="string">&quot;百级主办员其他&quot;</span>,<span class="attr">&quot;content2&quot;</span>:&#123;<span class="attr">&quot;fooNested&quot;</span>:<span class="string">&quot;百级主办员其他&quot;</span>&#125;&#125;,<span class="attr">&quot;sort&quot;</span>:[<span class="string">&quot;百级主办员其他&quot;</span>,<span class="string">&quot;baijizhubanyuanqita&quot;</span>]&#125;,&#123;<span class="attr">&quot;_index&quot;</span>:<span class="string">&quot;bar&quot;</span>,<span class="attr">&quot;_type&quot;</span>:<span class="string">&quot;_doc&quot;</span>,<span class="attr">&quot;_id&quot;</span>:<span class="string">&quot;15&quot;</span>,<span class="attr">&quot;_score&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;_source&quot;</span>:&#123;<span class="attr">&quot;content&quot;</span>:<span class="string">&quot;办员&quot;</span>,<span class="attr">&quot;content1&quot;</span>:<span class="string">&quot;办员&quot;</span>,<span class="attr">&quot;content2&quot;</span>:&#123;<span class="attr">&quot;fooNested&quot;</span>:<span class="string">&quot;办员&quot;</span>&#125;&#125;,<span class="attr">&quot;sort&quot;</span>:[<span class="string">&quot;办员&quot;</span>,<span class="string">&quot;banyuan&quot;</span>]&#125;,&#123;<span class="attr">&quot;_index&quot;</span>:<span class="string">&quot;bar&quot;</span>,<span class="attr">&quot;_type&quot;</span>:<span class="string">&quot;_doc&quot;</span>,<span class="attr">&quot;_id&quot;</span>:<span class="string">&quot;2&quot;</span>,<span class="attr">&quot;_score&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;_source&quot;</span>:&#123;<span class="attr">&quot;content&quot;</span>:<span class="string">&quot;二级主办员其他&quot;</span>,<span class="attr">&quot;content1&quot;</span>:<span class="string">&quot;二级主办员其他&quot;</span>,<span class="attr">&quot;content2&quot;</span>:&#123;<span class="attr">&quot;fooNested&quot;</span>:<span class="string">&quot;二级主办员其他&quot;</span>&#125;&#125;,<span class="attr">&quot;sort&quot;</span>:[<span class="string">&quot;二级主办员其他&quot;</span>,<span class="string">&quot;erjizhubanyuanqita&quot;</span>]&#125;,&#123;<span class="attr">&quot;_index&quot;</span>:<span class="string">&quot;bar&quot;</span>,<span class="attr">&quot;_type&quot;</span>:<span class="string">&quot;_doc&quot;</span>,<span class="attr">&quot;_id&quot;</span>:<span class="string">&quot;14&quot;</span>,<span class="attr">&quot;_score&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;_source&quot;</span>:&#123;<span class="attr">&quot;content&quot;</span>:<span class="string">&quot;主办&quot;</span>,<span class="attr">&quot;content1&quot;</span>:<span class="string">&quot;主办&quot;</span>,<span class="attr">&quot;content2&quot;</span>:&#123;<span class="attr">&quot;fooNested&quot;</span>:<span class="string">&quot;主办&quot;</span>&#125;&#125;,<span class="attr">&quot;sort&quot;</span>:[<span class="string">&quot;主办&quot;</span>,<span class="string">&quot;zhuban&quot;</span>]&#125;,&#123;<span class="attr">&quot;_index&quot;</span>:<span class="string">&quot;bar&quot;</span>,<span class="attr">&quot;_type&quot;</span>:<span class="string">&quot;_doc&quot;</span>,<span class="attr">&quot;_id&quot;</span>:<span class="string">&quot;16&quot;</span>,<span class="attr">&quot;_score&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;_source&quot;</span>:&#123;<span class="attr">&quot;content&quot;</span>:<span class="string">&quot;中国人民政府zhonguoshanghai13154123中国人民政府&quot;</span>,<span class="attr">&quot;content1&quot;</span>:<span class="string">&quot;中国人民政府zhonguoshanghai13154123中国人民政府&quot;</span>,<span class="attr">&quot;content2&quot;</span>:&#123;<span class="attr">&quot;fooNested&quot;</span>:<span class="string">&quot;中国人民政府zhonguoshanghai13154123中国人民政府&quot;</span>&#125;&#125;,<span class="attr">&quot;sort&quot;</span>:[<span class="string">&quot;中国人民政府zhonguoshanghai13154123中国人民政府&quot;</span>,<span class="string">&quot;zhongguorenminzhengfuzhonguoshanghai13154123zhongguorenminzhengfu&quot;</span>]&#125;,&#123;<span class="attr">&quot;_index&quot;</span>:<span class="string">&quot;bar&quot;</span>,<span class="attr">&quot;_type&quot;</span>:<span class="string">&quot;_doc&quot;</span>,<span class="attr">&quot;_id&quot;</span>:<span class="string">&quot;17&quot;</span>,<span class="attr">&quot;_score&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;_source&quot;</span>:&#123;<span class="attr">&quot;content&quot;</span>:<span class="string">&quot;中国人民政府zhonguoshanghai13154123&quot;</span>,<span class="attr">&quot;content1&quot;</span>:<span class="string">&quot;中国人民政府zhonguoshanghai13154123&quot;</span>,<span class="attr">&quot;content2&quot;</span>:&#123;<span class="attr">&quot;fooNested&quot;</span>:<span class="string">&quot;中国人民政府zhonguoshanghai13154123&quot;</span>&#125;&#125;,<span class="attr">&quot;sort&quot;</span>:[<span class="string">&quot;中国人民政府zhonguoshanghai13154123&quot;</span>,<span class="string">&quot;zhongguorenminzhengfuzhonguoshanghai13154123&quot;</span>]&#125;,&#123;<span class="attr">&quot;_index&quot;</span>:<span class="string">&quot;bar&quot;</span>,<span class="attr">&quot;_type&quot;</span>:<span class="string">&quot;_doc&quot;</span>,<span class="attr">&quot;_id&quot;</span>:<span class="string">&quot;1&quot;</span>,<span class="attr">&quot;_score&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;_source&quot;</span>:&#123;<span class="attr">&quot;content&quot;</span>:<span class="string">&quot;一级主办员其他&quot;</span>,<span class="attr">&quot;content1&quot;</span>:<span class="string">&quot;一级主办员其他&quot;</span>,<span class="attr">&quot;content2&quot;</span>:&#123;<span class="attr">&quot;fooNested&quot;</span>:<span class="string">&quot;一级主办员其他&quot;</span>&#125;&#125;,<span class="attr">&quot;sort&quot;</span>:[<span class="string">&quot;一级主办员其他&quot;</span>,<span class="string">&quot;yijizhubanyuanqita&quot;</span>]&#125;,&#123;<span class="attr">&quot;_index&quot;</span>:<span class="string">&quot;bar&quot;</span>,<span class="attr">&quot;_type&quot;</span>:<span class="string">&quot;_doc&quot;</span>,<span class="attr">&quot;_id&quot;</span>:<span class="string">&quot;18&quot;</span>,<span class="attr">&quot;_score&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;_source&quot;</span>:&#123;<span class="attr">&quot;content&quot;</span>:<span class="string">&quot;king中国&quot;</span>,<span class="attr">&quot;content1&quot;</span>:<span class="string">&quot;king中国&quot;</span>,<span class="attr">&quot;content2&quot;</span>:&#123;<span class="attr">&quot;fooNested&quot;</span>:<span class="string">&quot;king中国&quot;</span>&#125;&#125;,<span class="attr">&quot;sort&quot;</span>:[<span class="string">&quot;king中国&quot;</span>,<span class="string">&quot;kingzhongguo&quot;</span>]&#125;,&#123;<span class="attr">&quot;_index&quot;</span>:<span class="string">&quot;bar&quot;</span>,<span class="attr">&quot;_type&quot;</span>:<span class="string">&quot;_doc&quot;</span>,<span class="attr">&quot;_id&quot;</span>:<span class="string">&quot;20&quot;</span>,<span class="attr">&quot;_score&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;_source&quot;</span>:&#123;<span class="attr">&quot;content&quot;</span>:<span class="string">&quot;foo-9&quot;</span>,<span class="attr">&quot;content1&quot;</span>:<span class="string">&quot;foo-9&quot;</span>,<span class="attr">&quot;content2&quot;</span>:&#123;<span class="attr">&quot;fooNested&quot;</span>:<span class="string">&quot;foo-9&quot;</span>&#125;&#125;,<span class="attr">&quot;sort&quot;</span>:[<span class="string">&quot;foo-9&quot;</span>,<span class="string">&quot;foo9&quot;</span>]&#125;,&#123;<span class="attr">&quot;_index&quot;</span>:<span class="string">&quot;bar&quot;</span>,<span class="attr">&quot;_type&quot;</span>:<span class="string">&quot;_doc&quot;</span>,<span class="attr">&quot;_id&quot;</span>:<span class="string">&quot;23&quot;</span>,<span class="attr">&quot;_score&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;_source&quot;</span>:&#123;<span class="attr">&quot;content&quot;</span>:<span class="string">&quot;ch_1008&quot;</span>,<span class="attr">&quot;content1&quot;</span>:<span class="string">&quot;ch_1008&quot;</span>,<span class="attr">&quot;content2&quot;</span>:&#123;<span class="attr">&quot;fooNested&quot;</span>:<span class="string">&quot;ch_1008&quot;</span>&#125;&#125;,<span class="attr">&quot;sort&quot;</span>:[<span class="string">&quot;ch_1008&quot;</span>,<span class="string">&quot;ch1008&quot;</span>]&#125;,&#123;<span class="attr">&quot;_index&quot;</span>:<span class="string">&quot;bar&quot;</span>,<span class="attr">&quot;_type&quot;</span>:<span class="string">&quot;_doc&quot;</span>,<span class="attr">&quot;_id&quot;</span>:<span class="string">&quot;8&quot;</span>,<span class="attr">&quot;_score&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;_source&quot;</span>:&#123;<span class="attr">&quot;content&quot;</span>:<span class="string">&quot;b级主办员其他&quot;</span>,<span class="attr">&quot;content1&quot;</span>:<span class="string">&quot;b级主办员其他&quot;</span>,<span class="attr">&quot;content2&quot;</span>:&#123;<span class="attr">&quot;fooNested&quot;</span>:<span class="string">&quot;b级主办员其他&quot;</span>&#125;&#125;,<span class="attr">&quot;sort&quot;</span>:[<span class="string">&quot;b级主办员其他&quot;</span>,<span class="string">&quot;bjizhubanyuanqita&quot;</span>]&#125;,&#123;<span class="attr">&quot;_index&quot;</span>:<span class="string">&quot;bar&quot;</span>,<span class="attr">&quot;_type&quot;</span>:<span class="string">&quot;_doc&quot;</span>,<span class="attr">&quot;_id&quot;</span>:<span class="string">&quot;7&quot;</span>,<span class="attr">&quot;_score&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;_source&quot;</span>:&#123;<span class="attr">&quot;content&quot;</span>:<span class="string">&quot;a级主办员其他&quot;</span>,<span class="attr">&quot;content1&quot;</span>:<span class="string">&quot;a级主办员其他&quot;</span>,<span class="attr">&quot;content2&quot;</span>:&#123;<span class="attr">&quot;fooNested&quot;</span>:<span class="string">&quot;a级主办员其他&quot;</span>&#125;&#125;,<span class="attr">&quot;sort&quot;</span>:[<span class="string">&quot;a级主办员其他&quot;</span>,<span class="string">&quot;ajizhubanyuanqita&quot;</span>]&#125;,&#123;<span class="attr">&quot;_index&quot;</span>:<span class="string">&quot;bar&quot;</span>,<span class="attr">&quot;_type&quot;</span>:<span class="string">&quot;_doc&quot;</span>,<span class="attr">&quot;_id&quot;</span>:<span class="string">&quot;12&quot;</span>,<span class="attr">&quot;_score&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;_source&quot;</span>:&#123;<span class="attr">&quot;content&quot;</span>:<span class="string">&quot;ad级主办员其他&quot;</span>,<span class="attr">&quot;content1&quot;</span>:<span class="string">&quot;ad级主办员其他&quot;</span>,<span class="attr">&quot;content2&quot;</span>:&#123;<span class="attr">&quot;fooNested&quot;</span>:<span class="string">&quot;ad级主办员其他&quot;</span>&#125;&#125;,<span class="attr">&quot;sort&quot;</span>:[<span class="string">&quot;ad级主办员其他&quot;</span>,<span class="string">&quot;adjizhubanyuanqita&quot;</span>]&#125;,&#123;<span class="attr">&quot;_index&quot;</span>:<span class="string">&quot;bar&quot;</span>,<span class="attr">&quot;_type&quot;</span>:<span class="string">&quot;_doc&quot;</span>,<span class="attr">&quot;_id&quot;</span>:<span class="string">&quot;13&quot;</span>,<span class="attr">&quot;_score&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;_source&quot;</span>:&#123;<span class="attr">&quot;content&quot;</span>:<span class="string">&quot;ac级主办员其他&quot;</span>,<span class="attr">&quot;content1&quot;</span>:<span class="string">&quot;ac级主办员其他&quot;</span>,<span class="attr">&quot;content2&quot;</span>:&#123;<span class="attr">&quot;fooNested&quot;</span>:<span class="string">&quot;ac级主办员其他&quot;</span>&#125;&#125;,<span class="attr">&quot;sort&quot;</span>:[<span class="string">&quot;ac级主办员其他&quot;</span>,<span class="string">&quot;acjizhubanyuanqita&quot;</span>]&#125;,&#123;<span class="attr">&quot;_index&quot;</span>:<span class="string">&quot;bar&quot;</span>,<span class="attr">&quot;_type&quot;</span>:<span class="string">&quot;_doc&quot;</span>,<span class="attr">&quot;_id&quot;</span>:<span class="string">&quot;9&quot;</span>,<span class="attr">&quot;_score&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;_source&quot;</span>:&#123;<span class="attr">&quot;content&quot;</span>:<span class="string">&quot;aa级主办员其他&quot;</span>,<span class="attr">&quot;content1&quot;</span>:<span class="string">&quot;aa级主办员其他&quot;</span>,<span class="attr">&quot;content2&quot;</span>:&#123;<span class="attr">&quot;fooNested&quot;</span>:<span class="string">&quot;aa级主办员其他&quot;</span>&#125;&#125;,<span class="attr">&quot;sort&quot;</span>:[<span class="string">&quot;aa级主办员其他&quot;</span>,<span class="string">&quot;aajizhubanyuanqita&quot;</span>]&#125;,&#123;<span class="attr">&quot;_index&quot;</span>:<span class="string">&quot;bar&quot;</span>,<span class="attr">&quot;_type&quot;</span>:<span class="string">&quot;_doc&quot;</span>,<span class="attr">&quot;_id&quot;</span>:<span class="string">&quot;22&quot;</span>,<span class="attr">&quot;_score&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;_source&quot;</span>:&#123;<span class="attr">&quot;content&quot;</span>:<span class="string">&quot;ExternalId*+_38&quot;</span>,<span class="attr">&quot;content1&quot;</span>:<span class="string">&quot;ExternalId*+_38&quot;</span>,<span class="attr">&quot;content2&quot;</span>:&#123;<span class="attr">&quot;fooNested&quot;</span>:<span class="string">&quot;ExternalId*+_38&quot;</span>&#125;&#125;,<span class="attr">&quot;sort&quot;</span>:[<span class="string">&quot;ExternalId*+_38&quot;</span>,<span class="string">&quot;ExternalId38&quot;</span>]&#125;,&#123;<span class="attr">&quot;_index&quot;</span>:<span class="string">&quot;bar&quot;</span>,<span class="attr">&quot;_type&quot;</span>:<span class="string">&quot;_doc&quot;</span>,<span class="attr">&quot;_id&quot;</span>:<span class="string">&quot;6&quot;</span>,<span class="attr">&quot;_score&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;_source&quot;</span>:&#123;<span class="attr">&quot;content&quot;</span>:<span class="string">&quot;B级主办员其他&quot;</span>,<span class="attr">&quot;content1&quot;</span>:<span class="string">&quot;B级主办员其他&quot;</span>,<span class="attr">&quot;content2&quot;</span>:&#123;<span class="attr">&quot;fooNested&quot;</span>:<span class="string">&quot;B级主办员其他&quot;</span>&#125;&#125;,<span class="attr">&quot;sort&quot;</span>:[<span class="string">&quot;B级主办员其他&quot;</span>,<span class="string">&quot;Bjizhubanyuanqita&quot;</span>]&#125;,&#123;<span class="attr">&quot;_index&quot;</span>:<span class="string">&quot;bar&quot;</span>,<span class="attr">&quot;_type&quot;</span>:<span class="string">&quot;_doc&quot;</span>,<span class="attr">&quot;_id&quot;</span>:<span class="string">&quot;5&quot;</span>,<span class="attr">&quot;_score&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;_source&quot;</span>:&#123;<span class="attr">&quot;content&quot;</span>:<span class="string">&quot;A级主办员其他&quot;</span>,<span class="attr">&quot;content1&quot;</span>:<span class="string">&quot;A级主办员其他&quot;</span>,<span class="attr">&quot;content2&quot;</span>:&#123;<span class="attr">&quot;fooNested&quot;</span>:<span class="string">&quot;A级主办员其他&quot;</span>&#125;&#125;,<span class="attr">&quot;sort&quot;</span>:[<span class="string">&quot;A级主办员其他&quot;</span>,<span class="string">&quot;Ajizhubanyuanqita&quot;</span>]&#125;,&#123;<span class="attr">&quot;_index&quot;</span>:<span class="string">&quot;bar&quot;</span>,<span class="attr">&quot;_type&quot;</span>:<span class="string">&quot;_doc&quot;</span>,<span class="attr">&quot;_id&quot;</span>:<span class="string">&quot;4&quot;</span>,<span class="attr">&quot;_score&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;_source&quot;</span>:&#123;<span class="attr">&quot;content&quot;</span>:<span class="string">&quot;2级主办员其他&quot;</span>,<span class="attr">&quot;content1&quot;</span>:<span class="string">&quot;2级主办员其他&quot;</span>,<span class="attr">&quot;content2&quot;</span>:&#123;<span class="attr">&quot;fooNested&quot;</span>:<span class="string">&quot;2级主办员其他&quot;</span>&#125;&#125;,<span class="attr">&quot;sort&quot;</span>:[<span class="string">&quot;2级主办员其他&quot;</span>,<span class="string">&quot;2jizhubanyuanqita&quot;</span>]&#125;,&#123;<span class="attr">&quot;_index&quot;</span>:<span class="string">&quot;bar&quot;</span>,<span class="attr">&quot;_type&quot;</span>:<span class="string">&quot;_doc&quot;</span>,<span class="attr">&quot;_id&quot;</span>:<span class="string">&quot;3&quot;</span>,<span class="attr">&quot;_score&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;_source&quot;</span>:&#123;<span class="attr">&quot;content&quot;</span>:<span class="string">&quot;1级主办员其他&quot;</span>,<span class="attr">&quot;content1&quot;</span>:<span class="string">&quot;1级主办员其他&quot;</span>,<span class="attr">&quot;content2&quot;</span>:&#123;<span class="attr">&quot;fooNested&quot;</span>:<span class="string">&quot;1级主办员其他&quot;</span>&#125;&#125;,<span class="attr">&quot;sort&quot;</span>:[<span class="string">&quot;1级主办员其他&quot;</span>,<span class="string">&quot;1jizhubanyuanqita&quot;</span>]&#125;]&#125;&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="3参考"><a href="#3参考" class="headerlink" title="3参考"></a>3参考</h2><blockquote>
<p>该文档基于ElastciSearch版本为v6.8</p>
</blockquote>
<div id="refer-anchor-1"></div>

<ul>
<li>[1] <a target="_blank" rel="noopener" href="https://github.com/medcl/elasticsearch-analysis-pinyin/">ElasticSearch中文转拼音analysis</a></li>
</ul>
<div id="refer-anchor-2"></div>

<ul>
<li>[2] <a target="_blank" rel="noopener" href="https://www.elastic.co/guide/en/elasticsearch/reference/6.8/multi-fields.html#_multi_fields_with_multiple_analyzers">用不同的方式分析同一个字段以获得更好的相关性</a></li>
</ul>
<div id="refer-anchor-3"></div>

<ul>
<li>[3] <a target="_blank" rel="noopener" href="https://www.elastic.co/guide/en/elasticsearch/reference/6.8/search-request-sort.html#search-request-sort">sort和nested sort的说明</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.cubetech.group/2021/05/25/ElasticSearch%E4%B8%AD%E6%96%87%E6%8E%92%E5%BA%8F%E9%97%AE%E9%A2%98/" data-id="ckp7r97r30001oijd5799guxi" class="article-share-link">
        Share
      </a>
      
<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Elasticsearch/" rel="tag">Elasticsearch</a></li></ul>

    </footer>

  </div>

  
  
<nav class="article-nav">
  
  
  <a href="/2021/02/20/%E5%A6%82%E4%BD%95%E8%A7%A3%E5%86%B3Elasticsearch%E7%B4%A2%E5%BC%95%E6%95%B0%E6%8D%AE%E5%BB%B6%E8%BF%9F/" class="article-nav-link">
    <strong class="article-nav-caption">Older</strong>
    <div class="article-nav-title">如何解决Elasticsearch索引数据延迟</div>
  </a>
  
</nav>

  

  
  
  

  

</article>
</section>
    <footer class="footer">
  <div class="outer">
    <div class="float-right">
      <ul class="list-inline">
  
  <li><i class="fe fe-smile-alt"></i> <span id="busuanzi_value_site_uv"></span></li>
  
  <li><i class="fe fe-bookmark"></i> <span id="busuanzi_value_page_pv"></span></li>
  
</ul>
    </div>
    <ul class="list-inline">
      <li>CUBE &copy; 2021</li>
      
        <li></li>
      
    </ul>
  </div>
</footer>
  </main>
  <aside class="sidebar">
    <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/images/cubetech.png" alt="CUBE"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">首页</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">归档</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories">标签</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags">分类</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/gallery">相册</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/about">关于</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link nav-item-search" title="Search">
        <i class="fe fe-search"></i>
        Search
      </a>
    </li>
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      <div class="totop" id="totop">
  <i class="fe fe-rocket"></i>
</div>
    </li>
    <li class="nav-item">
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
  </aside>
  
<script src="/js/jquery-2.0.3.min.js"></script>


<script src="/js/jquery.justifiedGallery.min.js"></script>


<script src="/js/lazyload.min.js"></script>


<script src="/js/busuanzi-2.3.pure.min.js"></script>



<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/copybtn.js"></script>





<script src="/js/tocbot.min.js"></script>

<script>
  // Tocbot_v4.7.0  http://tscanlin.github.io/tocbot/
  tocbot.init({
    tocSelector: '.tocbot',
    contentSelector: '.article-entry',
    headingSelector: 'h1, h2, h3, h4, h5, h6',
    hasInnerContainers: true,
    scrollSmooth: true,
    positionFixedSelector: '.tocbot',
    positionFixedClass: 'is-position-fixed',
    fixedSidebarOffset: 'auto',
  });
</script>



<script src="/js/ocean.js"></script>

</body>

</html>